<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Professional Blog</title>
    <link rel="stylesheet" href="statics/styles.css">
    <script src="https://cdn.jsdelivr.net/npm/marked/marked.min.js"></script>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="nav-container">
            <div class="nav-logo">
                <a href="#">یه بلاگر تازه کار</a>
            </div>
            <ul class="nav-menu">
                <li><a href="#home">خانه</a></li>
                <li><a href="#posts">بلاگ</a></li>
                <li><a href="#about">درباره من</a></li>
                <li><a href="#contact">تماس با من</a></li>
            </ul>
        </div>
    </nav>

    <!-- Main Content -->
    <main id="content">
        <!-- Home Section -->
        <section id="home" class="section active">
            <div class="hero-banner">
                <div class="hero-content">
                    <h1 class="hero-title">به وبلاگ من خوش آمدید</h1>
                    <p class="hero-subtitle">Sharing thoughts, ideas, and experiences through writing</p>
                    <div class="hero-buttons">
                        <a href="#posts" class="btn btn-primary">Read Posts</a>
                        <a href="#about" class="btn btn-secondary">About Me</a>
                    </div>
                </div>
                <div class="hero-image">
                    <img src="media/banner-image.jpg" alt="Blog Banner" onerror="this.style.display='none'">
                </div>
            </div>

            <!-- Features Section -->
            <div class="features">
                <div class="feature-card">
                    <div class="feature-icon">📝</div>
                    <h3>Regular Posts</h3>
                    <p>Fresh content published regularly on various topics</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">🔍</div>
                    <h3>In-depth Analysis</h3>
                    <p>Detailed insights and comprehensive research</p>
                </div>
                <div class="feature-card">
                    <div class="feature-icon">💬</div>
                    <h3>Community</h3>
                    <p>Join the discussion and share your thoughts</p>
                </div>
            </div>
        </section>

        <!-- Posts Section -->
        <section id="posts" class="section">
            <div class="section-header">
                <h2>Latest Posts</h2>
                <p>Explore my recent writings and thoughts</p>
            </div>
            <div id="posts-container">
                <div class="loading">Loading posts...</div>
            </div>
        </section>

        <!-- About Section -->
        <section id="about" class="section">
            <div class="section-header">
                <h2>محب یاراحمدی هستم</h2>
                <p>Get to know the person behind the words</p>
            </div>
            <div class="about-content">
                <div class="about-image">
                    <img src="media/profile-pic.jpg" alt="Profile Picture" onerror="this.style.display='none'">
                </div>
                <div class="about-text">
                    <h3>سلام من محب هستم.</h3>
                    <p>به وبلاگ ساده ای که دارم خوش آمدید.</p>
                    <p>فکر میکنم همیشه شوق نوشتن داشتم ولی این اولین باره که عملیش کردم. اینجا قراره مطالب مفیدی بزارم. بیشتر آموزشیه. خودم آدم کنجکاوی هستم و برای همینم مطالب زیادی رو اغلب از منابع خوبی به دست میارم که فکر میکنم برای بعضیا هم شاید خوب باشه.</p>
                    <div class="skills">
                        <span class="skill-tag">Writing</span>
                        <span class="skill-tag">Technology</span>
                        <span class="skill-tag">Design</span>
                        <span class="skill-tag">Development</span>
                    </div>
                </div>
            </div>
        </section>

        <!-- Contact Section -->
        <section id="contact" class="section">
            <div class="section-header">
                <h2>Get In Touch</h2>
                <p>I'd love to hear from you</p>
            </div>
            <div class="contact-content">
                <div class="contact-info">
                    <div class="contact-item">
                        <div class="contact-icon">📧</div>
                        <div class="contact-details">
                            <h4>Email</h4>
                            <p>your.email@example.com</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">🌐</div>
                        <div class="contact-details">
                            <h4>Website</h4>
                            <p>www.yourwebsite.com</p>
                        </div>
                    </div>
                    <div class="contact-item">
                        <div class="contact-icon">📍</div>
                        <div class="contact-details">
                            <h4>Location</h4>
                            <p>Your City, Country</p>
                        </div>
                    </div>
                </div>
                <div class="social-links">
                    <a href="#" class="social-link">
                        <img src="media/social-icons/github.svg" alt="GitHub" onerror="this.parentElement.innerHTML='🐱'">
                    </a>
                    <a href="#" class="social-link">
                        <img src="media/social-icons/twitter.svg" alt="Twitter" onerror="this.parentElement.innerHTML='🐦'">
                    </a>
                    <a href="#" class="social-link">
                        <img src="media/social-icons/linkedin.svg" alt="LinkedIn" onerror="this.parentElement.innerHTML='💼'">
                    </a>
                    <a href="#" class="social-link">
                        <img src="media/social-icons/email.svg" alt="Email" onerror="this.parentElement.innerHTML='📧'">
                    </a>
                </div>
            </div>
        </section>

        <!-- Single Post View (hidden by default) -->
        <section id="single-post" class="section" style="display: none;">
            <div id="post-content"></div>
        </section>
    </main>

    <footer>
        <div class="footer-content">
            <p>&copy; 2024 My Professional Blog. All rights reserved.</p>
            <p>Powered by GitHub Pages & Markdown</p>
        </div>
    </footer>

    <script>
        // Configuration
        const REPO_OWNER = 'mohebyarahmadi';
        const REPO_NAME = 'blogforme';
        const POSTS_DIR = 'posts';

        // Navigation
        document.addEventListener('DOMContentLoaded', function() {
            // Handle navigation
            document.querySelectorAll('.nav-menu a, .hero-buttons a').forEach(link => {
                link.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href').substring(1);
                    showSection(targetId);

                    // Update URL without page reload
                    history.pushState(null, '', `#${targetId}`);
                });
            });

            // Handle browser back/forward
            window.addEventListener('popstate', function() {
                const hash = window.location.hash.substring(1) || 'home';
                showSection(hash);
            });

            // Load initial section
            const initialSection = window.location.hash.substring(1) || 'home';
            showSection(initialSection);

            // Load posts for posts section
            if (initialSection === 'posts') {
                loadHomePage();
            }
        });

        function showSection(sectionId) {
            // Hide all sections
            document.querySelectorAll('.section').forEach(section => {
                section.classList.remove('active');
                section.style.display = 'none';
            });

            // Show target section
            const targetSection = document.getElementById(sectionId);
            if (targetSection) {
                targetSection.style.display = 'block';
                setTimeout(() => targetSection.classList.add('active'), 10);
            }

            // Load posts if showing posts section
            if (sectionId === 'posts') {
                loadHomePage();
            }

            // Update active nav link
            document.querySelectorAll('.nav-menu a').forEach(link => {
                link.classList.remove('active');
                if (link.getAttribute('href') === `#${sectionId}`) {
                    link.classList.add('active');
                }
            });
        }

        // Posts loading functions (same as before, but updated for new structure)
        async function loadHomePage() {
            const container = document.getElementById('posts-container');
            try {
                container.innerHTML = '<div class="loading">Loading posts...</div>';

                const apiUrl = `https://api.github.com/repos/${REPO_OWNER}/${REPO_NAME}/contents/${POSTS_DIR}`;
                const response = await fetch(apiUrl);

                if (!response.ok) throw new Error(`Failed to fetch posts: ${response.status}`);

                const files = await response.json();
                const mdFiles = files.filter(file => file.name.endsWith('.md') && file.type === 'file');
                mdFiles.sort((a, b) => b.name.localeCompare(a.name));

                if (mdFiles.length === 0) {
                    container.innerHTML = '<div class="error">No markdown posts found.</div>';
                    return;
                }

                let html = '<div class="posts-grid">';
                mdFiles.forEach(file => {
                    const fileName = file.name.replace('.md', '');
                    const dateMatch = fileName.match(/^(\d{4}-\d{2}-\d{2})-/);
                    const date = dateMatch ? dateMatch[1] : 'Unknown date';
                    const title = dateMatch ? fileName.replace(dateMatch[0], '') : fileName;

                    html += `
                        <div class="post-card">
                            <a href="#" class="post-card-link" data-file="${file.name}">
                                <div class="post-card-content">
                                    <h3 class="post-card-title">${formatTitle(title)}</h3>
                                    <p class="post-card-date">${date}</p>
                                    <p class="post-card-excerpt">Click to read this post...</p>
                                </div>
                            </a>
                        </div>
                    `;
                });
                html += '</div>';
                container.innerHTML = html;

                // Add event listeners to post cards
                document.querySelectorAll('.post-card-link').forEach(link => {
                    link.addEventListener('click', function(e) {
                        e.preventDefault();
                        loadPost(this.getAttribute('data-file'));
                    });
                });

            } catch (error) {
                console.error('Error loading posts:', error);
                container.innerHTML = `<div class="error">Failed to load posts: ${error.message}</div>`;
            }
        }

        async function loadPost(filename) {
            try {
                showSection('single-post');
                const container = document.getElementById('post-content');
                container.innerHTML = '<div class="loading">Loading post...</div>';

                const rawUrl = `https://raw.githubusercontent.com/${REPO_OWNER}/${REPO_NAME}/main/${POSTS_DIR}/${filename}`;
                const response = await fetch(rawUrl);

                if (!response.ok) throw new Error(`Failed to fetch post: ${response.status}`);

                const markdown = await response.text();
                const htmlContent = marked.parse(markdown);
                const title = formatTitle(filename.replace('.md', ''));

                container.innerHTML = `
                    <a href="#posts" class="back-btn">← Back to all posts</a>
                    <article class="post-content">
                        <header class="post-header">
                            <h1>${title}</h1>
                            <div class="post-meta">
                                <span class="post-date">${filename.split('-').slice(0,3).join('-')}</span>
                            </div>
                        </header>
                        ${htmlContent}
                    </article>
                `;

                // Add back button event
                container.querySelector('.back-btn').addEventListener('click', function(e) {
                    e.preventDefault();
                    showSection('posts');
                });

            } catch (error) {
                console.error('Error loading post:', error);
                document.getElementById('post-content').innerHTML = `
                    <div class="error">Failed to load post: ${error.message}</div>
                    <a href="#posts" class="back-btn">← Back to all posts</a>
                `;
            }
        }

        function formatTitle(str) {
            return str.split('-').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        }
    </script>
</body>
</html>
